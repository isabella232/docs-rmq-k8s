---
title: Troubleshooting Pivotal RabbitMQ for Kubernetes
owner: RMQ for k8s
---

<strong><%= modified_date %></strong>

This topic describes how to troubleshoot common problems with <%= vars.product_full %>.

## <a id='failed-instance'></a> RabbitMQ Cluster Fails to Deploy

After creating a RabbitMQ instance, it is not available within a few minutes.

### <a name='failed-instance-symptom'></a> Symptom

* RabbitMQ Pods do not run.

### <a name='failed-instance-explanation'></a> Explanation

Common reasons for such failure are:

* Incorrect `imagePullSecret` configuration.
This prevents the image from being pulled from a Docker registry.
* Incorrect `storageClassName` configuration.

### <a name='failed-instance-solution'></a> Solution

See more details about the failure by following the step in
[Check the Status of an Instance](#check-instance-status) below to check
the status of the RabbitMQ cluster resources in your Kubernetes cluster.

After learning more about the failure, follow the advice in this topic that best corresponds to it or,
if that is not possible, please email pivotal-cf-feedback@pivotal.io for help.

## <a id='ts-install'></a> Troubleshoot the Installation

Follow the steps in the sections below to check that you can provision an instance with
<%= vars.app_runtime_full %> (<%= vars.app_runtime_abbr %>).


### <a id='check-instance-status'></a> Check the Status of an Instance

Follow the step below to check if an instance is running and see information about it.

1. View the status of an instance by running `kubectl -n NAMESPACE get all`.<br><br>

    Where `NAMESPACE` is the Kubernetes namespace of the instance.<br><br>

    For example:

    <pre class="terminal">
      $ kubectl -n p-rmq-instance-1 get all
      NAME                            READY   STATUS    RESTARTS   AGE
      pod/pivotal-rabbitmq-server-0   1/1     Running   0          2m27s

      NAME                                TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                        AGE
      service/pivotal-rabbitmq-headless   ClusterIP   None             <none>        4369/TCP                       2m27s
      service/pivotal-rabbitmq-ingress    ClusterIP   10.111.202.183   <none>        5672/TCP,15672/TCP,15692/TCP   2m28s

      NAME                                       READY   AGE
      statefulset.apps/pivotal-rabbitmq-server   1/1     2m28s
    </pre>

## <a id='no-pods'></a> Pods Are Not Being Created

### <a name='failed-instance-symptom'></a> Symptom

You see an error such as:

<pre class="terminal">
$ pods POD-NAME is forbidden: unable to validate against any pod security policy: []
</pre>

as an event of the underlying `ReplicaSet` of the Operator deployment, or as an
event of the underlying `StatefulSet` of the `RabbitmqCluster`.

### <a name='failed-instance-explanation'></a> Explanation

This occurs if Pod security policy admission control is enabled for the
Kubernetes cluster, but you have not created the necessary `PodSecurityPolicy` and
corresponding RBAC resources.

### <a name='failed-instance-solution'></a> Solution

Create the `PodSecurityPolicy` and RBAC resources by following the procedure in
[Pod Security Policies](./using.html#psp).
